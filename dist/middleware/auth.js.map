{"version":3,"sources":["../../src/middleware/auth.js"],"names":["AuthController","req","res","next","access_token","headers","User","findOne","error","user","status","json","length","controller"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;;;IAEaA,c,WAAAA,c;;;;;;;;;AAET;sCACcC,G,EAAKC,G,EAAKC,I,EAAM;AAAA,gBACpBC,YADoB,GACHH,IAAII,OADD,CACpBD,YADoB;;AAE1B,gBAAIA,YAAJ,EAAkB;AACdH,oBAAIK,IAAJ,CAASC,OAAT,CAAiB,EAAEH,0BAAF,EAAjB,EAAmC,UAACI,KAAD,EAAQC,IAAR,EAAiB;AAChD,wBAAID,KAAJ,EAAW;AACPL,6BAAKD,IAAIQ,MAAJ,6BAA+BC,IAA/B,CAAoC,2BAApC,CAAL;AACH,qBAFD,MAEO,IAAIF,SAAS,IAAT,IAAiBA,KAAKG,MAAL,KAAgB,CAArC,EAAwC;AAC3CT,6BAAKD,IAAIQ,MAAJ,sCAAwCC,IAAxC,CAA6C,4BAA7C,CAAL;AACH,qBAFM,MAEA;AACHV,4BAAIQ,IAAJ,GAAWA,IAAX;AACAN;AACH;AACJ,iBATD;AAUH,aAXD,MAWO;AACHA,qBAAKD,IAAIQ,MAAJ,mCAAqCC,IAArC,CAA0C,6DAA1C,CAAL;AACH;AACJ;;;;;;AAGL,IAAME,aAAa,IAAIb,cAAJ,EAAnB;kBACea,U","file":"auth.js","sourcesContent":["import { BAD_REQUEST_STATUS, INVALID_ACCESS_TOKEN_STATUS, PARAMETER_MISSING_STATUS } from '../constant/status';\nimport { successResult, serverError, invalidToken, parameterMissing } from \"../modules/generic\";\nimport { ACCESS_TOKEN_MISSING } from '../constant/message';\n\nexport class AuthController {\n\n    // middleware for logged in users\n    requiresLogin(req, res, next) {\n        let { access_token } = req.headers;\n        if (access_token) {\n            req.User.findOne({ access_token }, (error, user) => {\n                if (error) {\n                    next(res.status(BAD_REQUEST_STATUS).json(serverError()));\n                } else if (user === null || user.length === 0) {\n                    next(res.status(INVALID_ACCESS_TOKEN_STATUS).json(invalidToken()));\n                } else {\n                    req.user = user;\n                    next();\n                }\n            })\n        } else {\n            next(res.status(PARAMETER_MISSING_STATUS).json(parameterMissing(ACCESS_TOKEN_MISSING)));\n        }\n    }\n}\n\nconst controller = new AuthController();\nexport default controller;"]}